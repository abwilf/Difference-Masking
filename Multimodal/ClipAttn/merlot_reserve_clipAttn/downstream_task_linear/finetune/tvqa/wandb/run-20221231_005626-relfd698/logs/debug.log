2022-12-31 00:56:26,421 INFO    MainThread:2103745 [wandb_setup.py:_flush():68] Configure stats pid to 2103745
2022-12-31 00:56:26,421 INFO    MainThread:2103745 [wandb_setup.py:_flush():68] Loading settings from /home/sakter/.config/wandb/settings
2022-12-31 00:56:26,421 INFO    MainThread:2103745 [wandb_setup.py:_flush():68] Loading settings from /home/sakter/merlot_reserve_clipAttn/downstream_task_linear/finetune/tvqa/wandb/settings
2022-12-31 00:56:26,421 INFO    MainThread:2103745 [wandb_setup.py:_flush():68] Loading settings from environment variables: {'_require_service': 'True', 'entity': 'snat', 'project': 'merlotreserve-tvqa-finetune', 'sweep_id': 'yh1fw0yr', 'root_dir': '/home/sakter/merlot_reserve_clipAttn/downstream_task_linear/finetune/tvqa', 'run_id': 'relfd698', 'sweep_param_path': '/home/sakter/merlot_reserve_clipAttn/downstream_task_linear/finetune/tvqa/wandb/sweep-yh1fw0yr/config-relfd698.yaml'}
2022-12-31 00:56:26,421 INFO    MainThread:2103745 [wandb_setup.py:_flush():68] Inferring run settings from compute environment: {'program_relpath': 'tvqa_finetune.py', 'program': '/home/sakter/merlot_reserve_clipAttn/downstream_task_linear/finetune/tvqa/tvqa_finetune.py'}
2022-12-31 00:56:26,422 INFO    MainThread:2103745 [wandb_init.py:_log_setup():476] Logging user logs to /home/sakter/merlot_reserve_clipAttn/downstream_task_linear/finetune/tvqa/wandb/run-20221231_005626-relfd698/logs/debug.log
2022-12-31 00:56:26,422 INFO    MainThread:2103745 [wandb_init.py:_log_setup():477] Logging internal logs to /home/sakter/merlot_reserve_clipAttn/downstream_task_linear/finetune/tvqa/wandb/run-20221231_005626-relfd698/logs/debug-internal.log
2022-12-31 00:56:26,422 INFO    MainThread:2103745 [wandb_init.py:init():516] calling init triggers
2022-12-31 00:56:26,422 INFO    MainThread:2103745 [wandb_init.py:init():519] wandb.init called with sweep_config: {'alpha': 0.8, 'extn': '_run_1', 'joint_proj': 'no_proj', 'lr': 5e-06, 'mask_where': 'clipAttn', 'ne': 3, 'output_grid_h': 12, 'output_grid_w': 24, 'percent_data': 1}
config: {'data': {'train_fns': '/data/sakter/preprocessed_clip/out/train{:03d}of256.tfrecord', 'num_train_files': 256, 'use_audio_token_prob': 0.5, 'random_scale_max': 1.1, 'random_scale_min': 1.0, 'fft_hop_length': 588, 'fft_window_size': 1536, 'num_mels': 64, 'sample_rate': 22050, 'spec_size': 188, 'mask_rate': 0.25, 'num_audio2text_seqs': 1, 'num_text2audio_seqs': 1, 'num_text_seqs': 1, 'num_text_seqs_in_record': 1, 'num_segments': 7, 'num_segment_groups': 2, 'num_audio_subsegments': 3, 'seq_len': 640, 'lang_seq_len': 256, 'num_text_spans_to_include': 48, 'text_span_budget': 38, 'num_answers': 5, 'mask_where': 'clipAttn', 'alpha': 0.8}, 'model': {'hidden_size': 768, 'joint_num_layers': 12, 'use_bfloat16': True, 'audio_num_layers': 12, 'audio_patch_size': 2, 'audio_seq_length': 60, 'audio_token_length': 6, 'output_grid': [12, 24], 'vit_patch_size': 16, 'vit_pooling_ratio': 2, 'vit_num_layers': 12, 'span_num_layers': 4, 'text_span_length': 15}, 'device': {'use_tpu': True, 'num_tpu_cores': 512, 'output_dir': '/home/sakter/results/retrain/finetune_clip/base.yaml/tvqa_clipAttn_1.0_12_24_0.8_no_proj_run_1', 'batch_size': 8, 'iterations_per_loop': 15264, 'commit_every_nsteps': 50, 'n_fns_per_cycle': 256, 'num_parallel_reads': 128, 'shuffle_buffer_size': 4096, 'wandb_project': 'merlotreserve', 'prefetch_size': 0}, 'optimizer': {'beta_2': 0.98, 'eps': 1e-06, 'learning_rate': 5e-06, 'num_train_steps': 45792, 'num_warmup_steps': 7632, 'use_bfloat16_adam': True, 'weight_decay_rate': 0.1, 'do_bias_correction': True}, '_ckpt': '/home/sakter/results/retrain/out_clip/base.yaml/tvqa_clipAttn_1.0_12_24_0.8_no_proj_run_1/ckpt_45792'}
2022-12-31 00:56:26,422 INFO    MainThread:2103745 [wandb_init.py:init():569] starting backend
2022-12-31 00:56:26,422 INFO    MainThread:2103745 [wandb_init.py:init():573] setting up manager
2022-12-31 00:56:26,427 INFO    MainThread:2103745 [backend.py:_multiprocessing_setup():102] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2022-12-31 00:56:26,431 INFO    MainThread:2103745 [wandb_init.py:init():580] backend started and connected
2022-12-31 00:56:26,435 INFO    MainThread:2103745 [wandb_run.py:_config_callback():1145] config_cb None None {'alpha': 0.8, 'extn': '_run_1', 'joint_proj': 'no_proj', 'lr': 5e-06, 'mask_where': 'clipAttn', 'ne': 3, 'output_grid_h': 12, 'output_grid_w': 24, 'percent_data': 1}
2022-12-31 00:56:26,439 INFO    MainThread:2103745 [wandb_init.py:init():658] updated telemetry
2022-12-31 00:56:26,440 INFO    MainThread:2103745 [wandb_init.py:init():692] communicating run to backend with 30 second timeout
2022-12-31 00:56:26,560 INFO    MainThread:2103745 [wandb_run.py:_on_init():1974] communicating current version
2022-12-31 00:56:26,629 INFO    MainThread:2103745 [wandb_run.py:_on_init():1978] got version response upgrade_message: "wandb version 0.13.7 is available!  To upgrade, please run:\n $ pip install wandb --upgrade"

2022-12-31 00:56:26,629 INFO    MainThread:2103745 [wandb_init.py:init():727] starting run threads in backend
2022-12-31 00:56:30,502 INFO    MainThread:2103745 [wandb_run.py:_console_start():1954] atexit reg
2022-12-31 00:56:30,502 INFO    MainThread:2103745 [wandb_run.py:_redirect():1812] redirect: SettingsConsole.WRAP_RAW
2022-12-31 00:56:30,502 INFO    MainThread:2103745 [wandb_run.py:_redirect():1877] Wrapping output streams.
2022-12-31 00:56:30,502 INFO    MainThread:2103745 [wandb_run.py:_redirect():1899] Redirects installed.
2022-12-31 00:56:30,503 INFO    MainThread:2103745 [wandb_init.py:init():764] run started, returning control to user process
2022-12-31 07:38:13,795 WARNING MsgRouterThr:2103745 [router.py:message_loop():77] message_loop has been closed
